{
  "hash": "ea62f2d2a06b688fa9eb28d4d7b1f392",
  "result": {
    "markdown": "---\ntitle: \"The Art & Science of <br>Data Visualization \"\nsubtitle: \"<span style='font-size:1.5em;'>Engaging and Reproducible Graphics with ggplot2</span><br><span style='font-weight:500;font-size:1.3em;'>Working with Labels and Annotations</span></span>\"\nauthor: \"<b style='color:#28a87d;'><a href='https://www.cedricscherer.com'>Dr. Cédric Scherer</a></b>&ensp;**//**&ensp;RTG-UGI Workshop&ensp;**//**&ensp;October 2023\"\nformat:\n  revealjs:\n    theme: slides.scss\n    logo: img/logo.png\n    footer: '**[Cédric Scherer](https://cedricscherer.com)** // Data Visualization & Information Design'\n    transition: fade\n    progress: true\n    multiplex: false\n    preview-links: true\n    scrollable: false\n    hide-inactive-cursor: true\n    highlight-style: printing\n    chalkboard:\n      theme: whiteboard\n      boardmarker-width: 4\n      buttons: true\n    pause: true\n    mainfont: Asap SemiCondensed\neditor: source\nknitr:\n  opts_chunk:\n    dev: \"ragg_png\"\n    retina: 3\n    dpi: 200\nexecute:\n  freeze: auto\n  cache: true\n  echo: true\n  fig-width: 5\n  fig-height: 6\n---\n\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(stringr)\n\nbikes <- readr::read_csv(\n  here::here(\"data\", \"london-bikes-custom.csv\"),\n  col_types = \"Dcfffilllddddc\"\n)\n\nbikes$season <- forcats::fct_inorder(bikes$season)\n\ntheme_set(theme_light(base_size = 14, base_family = \"Asap SemiCondensed\"))\n\ntheme_update(\n  panel.grid.minor = element_blank(),\n  legend.position = \"top\"\n)\n```\n:::\n\n\n\n\n# Labels + `theme()`\n\n\n\n## Working with Labels\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"9,10,11,12,13,14,15,16,17\"}\ng <- ggplot(\n    bikes,\n    aes(x = temp, y = count,\n        color = season)\n  ) +\n  geom_point(\n    alpha = .5\n  ) +\n  labs(\n    x = \"Temperature (°C)\",\n    y = \"Reported bike shares\",\n    title = \"TfL bike sharing trends\",\n    subtitle = \"Reported bike rents versus temperature in London\",\n    caption = \"Data: TfL\",\n    color = \"Season:\",\n    tag = \"1.\"\n  )\n\ng\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-labs-bundled-extended-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Customize Labels via \\`theme()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggplot-theme-title_d7bda74734ab8058cdc2d4b73290f8b6'}\n\n```{.r .cell-code}\ng + theme(\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\"\n)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-theme-title-1.png){width=1000}\n:::\n:::\n\n\n## Customize Labels via \\`theme()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggplot-labs-theme-element-text_cb2e1948b691f6f5924ae4bb459b1853'}\n\n```{.r .cell-code  code-line-numbers=\"4,5,6\"}\ng + theme(\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\",\n  axis.text = element_text(\n    color = \"#28a87d\"\n  )\n)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-labs-theme-element-text-1.png){width=1000}\n:::\n:::\n\n\n\n## Customize Labels via \\`theme()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggplot-labs-theme-element-text-more_89f94a3fb862560463fd41ded8399b43'}\n\n```{.r .cell-code  code-line-numbers=\"6,7,8|9,10,11,12\"}\ng + theme(\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\",\n  axis.text = element_text(\n    color = \"#28a87d\",\n    family = \"Spline Sans Mono\",\n    face = \"italic\",\n    lineheight = 1.3, # no effect here\n    angle = 45,\n    hjust = 1,\n    vjust = 0,\n    margin = margin(10, 0, 20, 0)\n  )\n)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-labs-theme-element-text-more-1.png){width=1000}\n:::\n:::\n\n\n\n## Customize Labels via \\`theme()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggplot-labs-theme-element-text-no-effect_9ce48a2476e2c3cb7979d2911142c38a'}\n\n```{.r .cell-code  code-line-numbers=\"10,11,12\"}\ng + theme(\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\",\n  axis.text = element_text(\n    color = \"#28a87d\",\n    family = \"Spline Sans Mono\",\n    face = \"italic\",\n    lineheight = 1.3, # no effect here\n    angle = 45,\n    hjust = 1, # no effect here\n    vjust = 0, # no effect here\n    margin = margin(10, 0, 20, 0) # no effect here\n  )\n)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-labs-theme-element-text-no-effect-1.png){width=1000}\n:::\n:::\n\n\n\n## Customize Labels via \\`theme()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggplot-labs-theme-element-text-x_b0b4426e0f1d8c17d6ad8ad273a17992'}\n\n```{.r .cell-code  code-line-numbers=\"14,15,16,17,18\"}\ng + theme(\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\",\n  axis.text = element_text(\n    color = \"#28a87d\",\n    family = \"Spline Sans Mono\",\n    face = \"italic\",\n    lineheight = 1.3, # no effect here\n    angle = 45,\n    hjust = 1, # no effect here\n    vjust = 0, # no effect here\n    margin = margin(10, 0, 20, 0) # no effect here\n  ),\n  axis.text.x = element_text(\n    hjust = 1,\n    vjust = 0,\n    margin = margin(10, 0, 20, 0) # trbl\n  )\n)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-labs-theme-element-text-x-1.png){width=1000}\n:::\n:::\n\n\n\n## Customize Labels via \\`theme()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggplot-labs-theme-element-text-tag_d0c0ae8e141147d69e8dab0ad8e951c1'}\n\n```{.r .cell-code  code-line-numbers=\"14,15,16\"}\ng + theme(\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\",\n  axis.text = element_text(\n    color = \"#28a87d\",\n    family = \"Spline Sans Mono\",\n    face = \"italic\",\n    lineheight = 1.3, # no effect here\n    angle = 45,\n    hjust = 1, # no effect here\n    vjust = 0, # no effect here\n    margin = margin(10, 0, 20, 0) # no effect here\n  ),\n  plot.tag = element_text(\n    margin = margin(0, 12, -8, 0) # trbl\n  )\n)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-labs-theme-element-text-tag-1.png){width=1000}\n:::\n:::\n\n\n\n## Customize Labels via \\`theme()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggplot-labs-theme-element-text-debug_90fc44243ef3e6b8e25398be8671f8b0'}\n\n```{.r .cell-code  code-line-numbers=\"13,17\"}\ng + theme(\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\",\n  axis.text = element_text(\n    color = \"#28a87d\",\n    family = \"Spline Sans Mono\",\n    face = \"italic\",\n    hjust = 1,\n    vjust = 0,\n    angle = 45,\n    lineheight = 1.3, # no effect here\n    margin = margin(10, 0, 20, 0), # no effect here\n    debug = TRUE\n  ),\n  plot.tag = element_text(\n    margin = margin(0, 12, -8, 0), # trbl\n    debug = TRUE\n  )\n)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggplot-labs-theme-element-text-debug-1.png){width=1000}\n:::\n:::\n\n\n\n\n# Labels + `scale_*()`\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-continuous-labels-scales-prep_6bf58da22c1817db85c648f2b21d0fa8'}\n\n```{.r .cell-code  code-line-numbers=\"1,2|4,5,6,7\"}\ng <- g + labs(tag = NULL, title = NULL, \n              subtitle = NULL)\n\ng +\n  scale_y_continuous(\n    breaks = 0:4*15000\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-continuous-labels-scales-prep-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-continuous-labels-scales-1_9ddc966c833aa7d0e04ad3f60d736849'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\ng +\n  scale_y_continuous(\n    breaks = 0:4*15000,\n    labels = scales::comma_format()\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-continuous-labels-scales-1-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-continuous-labels-scales-2_4f47430ff2eef453b02dd0503b0df136'}\n\n```{.r .cell-code  code-line-numbers=\"4,5,6|5|7\"}\ng +\n  scale_y_continuous(\n    breaks = 0:4*15000,\n    labels = scales::comma_format(\n      suffix = \" bikes\"\n    ),\n    name = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-continuous-labels-scales-2-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-continuous-labels-scales-3_8b925d81a1bea71d64e1bef673ef486b'}\n\n```{.r .cell-code  code-line-numbers=\"5|9,10,11,12,13\"}\ng +\n  scale_y_continuous(\n    breaks = 0:4*15000,\n    labels = scales::comma_format(\n      suffix = \"\\nbikes shared\"\n    ),\n    name = NULL\n  ) +\n  theme(\n    axis.text.y = element_text(\n      hjust = .5\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-continuous-labels-scales-3-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-continuous-labels-scales-4_baa4e75adbf1412c5cc6c8e7f3750fab'}\n\n```{.r .cell-code  code-line-numbers=\"5|5,7\"}\ng +\n  scale_y_continuous(\n    breaks = 0:4*15000,\n    labels = scales::comma_format(\n      scale = .001\n    ),\n    name = \"Reported bike shares in thousands\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-continuous-labels-scales-4-1.png){width=1000}\n:::\n:::\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-continuous-labels-function_35db834aa4a44d1418a121d130b27ee8'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\ng +\n  scale_y_continuous(\n    breaks = 0:4*15000,\n    labels = function(y) y / 1000,\n    name = \"Reported bike shares in thousands\",\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-continuous-labels-function-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-continuous-labels-function-paste_c861ec08d48ce8f6e4b95ae681e07d6e'}\n\n```{.r .cell-code  code-line-numbers=\"2,5|3|4\"}\ng +\n  scale_x_continuous(\n    labels = function(y) paste0(y, \"°C\"),\n    name = \"Temperature\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-continuous-labels-function-paste-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-discrete-labels_1eb640a0b2eb83c9e50d2cd5982f5197'}\n\n```{.r .cell-code}\nggplot(\n    bikes,\n    aes(x = season, y = count)\n  ) +\n  geom_boxplot() +\n  scale_x_discrete()\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-discrete-labels-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-xy-discrete-labels-function_0bb4047de176e231271f9ad46e82c622'}\n\n```{.r .cell-code  code-line-numbers=\"8|7,8\"}\nggplot(\n    bikes,\n    aes(x = season, y = count)\n  ) +\n  geom_boxplot() +\n  scale_x_discrete(\n    name = NULL,\n    labels = stringr::str_to_title\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-xy-discrete-labels-function-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Format Labels via \\`scale\\_\\*\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/scales-color-discrete-name-labels_bf5fe8813339c782db00f564a6f534ef'}\n\n```{.r .cell-code  code-line-numbers=\"2,4\"}\ng +\n  scale_color_discrete(\n    name = NULL,\n    labels = stringr::str_to_title\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/scales-color-discrete-name-labels-1.png){width=1000}\n:::\n:::\n\n\n\n\n# Labels +<br>`element_markdown`\n\n\n\n## Styling Labels with {ggtext}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-prep-markdown_4d53f3302b89bcde1cd873aa4688c303'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\n# install.packages(\"ggtext\")\n\ng +\n  ggtitle(\"**TfL bike sharing trends by _season_**\")\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-prep-markdown-1.png){width=1000}\n:::\n:::\n\n\n## Styling Labels with {ggtext}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-element-markdown_498bb7ec360f4d551fa9ff7e32cec84c'}\n\n```{.r .cell-code  code-line-numbers=\"4,5,6,7|4|6\"}\n# install.packages(\"ggtext\")\n\ng +\n  ggtitle(\"**TfL bike sharing trends by _season_**\") +\n  theme(\n    plot.title = ggtext::element_markdown()\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-element-markdown-1.png){width=1000}\n:::\n:::\n\n\n## Styling Labels with {ggtext}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-element-markdown-html_d2758be28eb7cf88456d1859bc74174b'}\n\n```{.r .cell-code  code-line-numbers=\"4|4,6\"}\n# install.packages(\"ggtext\")\n\ng +\n  ggtitle(\"<b style='font-size:25pt'>TfL</b> bike sharing trends by <i style='color:#28a87d;'>season</i>\") +\n  theme(\n    plot.title = ggtext::element_markdown()\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-element-markdown-html-1.png){width=1000}\n:::\n:::\n\n\n<div style=\"font-size:15pt;\">\n\n`<b style='font-size:15pt;'>TfL</b> bike sharing trends by <i style='color:#28a87d;'>season</i>`\n\n</div>\n\n\n\n# Handling Long Labels\n\n\n\n## Handling Long Labels with {stringr}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/stringr-default-labs_59457107aaf5bf5a6e8d21b2e6573d11'}\n\n```{.r .cell-code}\nggplot(\n    bikes,\n    aes(x = weather_type,\n        y = count)\n  ) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/stringr-default-labs-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Handling Long Labels with {stringr}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/stringr-wrap-labs_6f87765d95fddda177b4bd35e3100b40'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(\n    bikes,\n    aes(x = stringr::str_wrap(weather_type, 6),\n        y = count)\n  ) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/stringr-wrap-labs-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Handling Long Labels with {ggtext}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-text-default_8aa45dbf58d4796dc563bbee28c99df2'}\n\n```{.r .cell-code  code-line-numbers=\"2|3,4,5,6|4\"}\ng +\n  ggtitle(\"TfL bike sharing trends in 2015 and 2016 by season for day and night periods\") +\n  theme(\n    plot.title = element_text(size = 20),\n    plot.title.position = \"plot\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-text-default-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Handling Long Titles\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-textbox-default_83e89c57226aec4f006874174e560fbd'}\n\n```{.r .cell-code  code-line-numbers=\"5,6,7\"}\ng +\n  ggtitle(\"TfL bike sharing trends in 2015 and 2016 by season for day and night periods\") +\n  theme(\n    plot.title =\n      ggtext::element_textbox_simple(\n        size = 20\n      ),\n    plot.title.position = \"plot\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-textbox-default-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Handling Long Titles\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-textbox-margin_26b1607ba9748dceca4f80de8351d257'}\n\n```{.r .cell-code  code-line-numbers=\"6,7\"}\ng +\n  ggtitle(\"TfL bike sharing trends in 2015 and 2016 by season for day and night periods\") +\n  theme(\n    plot.title = \n      ggtext::element_textbox_simple(\n        margin = margin(t = 12, b = 12),\n        lineheight = .9\n      ),\n    plot.title.position = \"plot\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-textbox-margin-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Handling Long Titles\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-textbox-box_26653a721611e576094941acee0f3861'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\ng +\n  ggtitle(\"TfL bike sharing trends in 2015 and 2016 by season for day and night periods\") +\n  theme(\n    plot.title = \n      ggtext::element_textbox_simple(\n        margin = margin(t = 12, b = 12),\n        fill = \"grey90\",\n        lineheight = .9\n      ),\n    plot.title.position = \"plot\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-textbox-box-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Handling Long Titles\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/ggtext-textbox-box-styled_f913988227d2dcca97f4d750a659700a'}\n\n```{.r .cell-code  code-line-numbers=\"7|9|10|11|12|13\"}\ng +\n  ggtitle(\"TfL bike sharing trends in 2015 and 2016 by season for day and night periods\") +\n  theme(\n    plot.title = \n      ggtext::element_textbox_simple(\n        margin = margin(t = 12, b = 12),\n        padding = margin(rep(12, 4)),\n        fill = \"grey90\",\n        box.colour = \"grey30\",\n        linetype = \"13\",\n        r = unit(9, \"pt\"),\n        halign = .5,\n        face = \"bold\",\n        lineheight = .9\n      ),\n    plot.title.position = \"plot\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/ggtext-textbox-box-styled-1.png){width=1000}\n:::\n:::\n\n\n\n\n# Annotations &<br>Call-Outs\n\n\n\n## Add Single Text Annotations\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-setup_093487364cf9d42fd9ec6a3f1e560843'}\n\n```{.r .cell-code  code-line-numbers=\"1|2,3|4,5,6,7|8,9,10,11|5,9\"}\nga <- \n  ggplot(bikes, \n         aes(x = temp, y = count)) +\n  geom_point(\n    aes(color = count > 40000),\n    size = 2\n  ) +\n  scale_color_manual(\n    values = c(\"grey\", \"firebrick\"),\n    guide = \"none\"\n  )\n\nga\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-setup-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Add Single Text Annotations\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text_9f092cb1722ad5a0d6bf9a35b9b16387'}\n\n```{.r .cell-code  code-line-numbers=\"1,2,3,4,5,6|2|3,4|5\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = 18,\n    y = 48000,\n    label = \"What happened here?\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-1.png){width=1000}\n:::\n:::\n\n\n\n\n\n## Style Text Annotations\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-adj_6651452290f9252f4dd0cbfb21059344'}\n\n```{.r .cell-code  code-line-numbers=\"7,8,9,10,11\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = 18,\n    y = 48000,\n    label = \"What happened here?\",\n    color = \"firebrick\",\n    size = 6,\n    family = \"Asap SemiCondensed\",\n    fontface = \"bold\",\n    lineheight =  .8\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-adj-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Add Multiple Text Annotations\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-multiple_38003dea3f1ee5876efad869bdf9ccdc'}\n\n```{.r .cell-code  code-line-numbers=\"4,5,6|4,5,6,7,8,9,10,11\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = c(18, max(bikes$temp)),\n    y = c(48000, 1000),\n    label = c(\"What happened here?\", \"Powered by TfL\"),\n    color = c(\"firebrick\", \"black\"),\n    size = c(6, 3),\n    family = c(\"Asap SemiCondensed\", \"Hepta Slab\"),\n    fontface = c(\"bold\", \"plain\"),\n    hjust = c(.5, 1)\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-multiple-1.png){width=1000}\n:::\n:::\n\n\n\n\n## \"Point'n'Click\" Annotations\n\n\n::: {.cell hash='04-annotations_cache/revealjs/ggannotate_f899e0db430553d935883df4e1bd80c5'}\n\n```{.r .cell-code}\nggannotate::ggannotate(g)\n```\n:::\n\n\n![](img/annotations/ggannotate.png){fig-align=\"center\" fig-alt=\"A screenshot of the Shiny app provided by the ggannotate package which allows to place a text annotation by clicking and returns the code.\"}\n\n\n\n## Add Boxes\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-rect_c99c122796e526fe51dfa77455ba1cb6'}\n\n```{.r .cell-code  code-line-numbers=\"11,18|11,12,18|13,14,15,16|17,18|5,8,15\"}\nga + \n  annotate(\n    geom = \"text\",\n    x = 19.5,\n    y = 42000,\n    label = \"What happened here?\",\n    family = \"Asap SemiCondensed\",\n    size = 6,\n    vjust = 1.3\n  ) +\n  annotate(\n    geom = \"rect\",\n    xmin = 17, \n    xmax = 22,\n    ymin = 42000, \n    ymax = 54000,\n    color = \"firebrick\", \n    fill = NA\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-rect-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Add Lines\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-line_71016b624bffcf27ab10d4b63fdfe18f'}\n\n```{.r .cell-code  code-line-numbers=\"11,17|12|13,14,15,16|4,5,13,15\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = 10,\n    y = 38000,\n    label = \"The\\nhighest\\ncount\",\n    family = \"Asap SemiCondensed\",\n    size = 6,\n    lineheight =  .8\n  ) +\n  annotate(\n    geom = \"segment\",\n    x = 13, \n    xend = 18.2,\n    y = 38000, \n    yend = 51870\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-line-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Add Lines\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-curve_644eb556e657db34619227e468b9874f'}\n\n```{.r .cell-code  code-line-numbers=\"13,14,15,16|6,11,15\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = 10,\n    y = 38000,\n    label = \"The\\nhighest\\ncount\",\n    family = \"Asap SemiCondensed\",\n    size = 6,\n    lineheight =  .8\n  ) +\n  annotate(\n    geom = \"curve\",\n    x = 13, \n    xend = 18.2,\n    y = 38000, \n    yend = 51870\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-curve-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Add Arrows\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-arrow_29741799766ef77a4043217109ef4ca3'}\n\n```{.r .cell-code  code-line-numbers=\"17,18\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = 10,\n    y = 38000,\n    label = \"The\\nhighest\\ncount\",\n    family = \"Asap SemiCondensed\",\n    size = 6,\n    lineheight =  .8\n  ) +\n  annotate(\n    geom = \"curve\",\n    x = 13, \n    xend = 18.2,\n    y = 38000, \n    yend = 51870,\n    curvature = .25,\n    arrow = arrow()\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-arrow-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Add Arrows\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-arrow-type2_812645c88c40103455dc323f50e4dc83'}\n\n```{.r .cell-code  code-line-numbers=\"18,19,20,21,22|19,20,21\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = 10,\n    y = 38000,\n    label = \"The\\nhighest\\ncount\",\n    family = \"Asap SemiCondensed\",\n    size = 6,\n    lineheight =  .8\n  ) +\n  annotate(\n    geom = \"curve\",\n    x = 13, \n    xend = 18.2,\n    y = 38000, \n    yend = 51870,\n    curvature = .25,\n    arrow = arrow(\n      length = unit(10, \"pt\"),\n      type = \"closed\",\n      ends = \"both\"\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-arrow-type2-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Add Arrows\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-text-arrow-skewed_4b26fee08c44b8ae9e3e154015a35f89'}\n\n```{.r .cell-code  code-line-numbers=\"18|19,20,21,22\"}\nga +\n  annotate(\n    geom = \"text\",\n    x = 10,\n    y = 38000,\n    label = \"The\\nhighest\\ncount\",\n    family = \"Asap SemiCondensed\",\n    size = 6,\n    lineheight =  .8\n  ) +\n  annotate(\n    geom = \"curve\",\n    x = 13, \n    xend = 18.2,\n    y = 38000, \n    yend = 51870,\n    curvature = .8,\n    angle = 130,\n    arrow = arrow(\n      length = unit(10, \"pt\"),\n      type = \"closed\"\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-text-arrow-skewed-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Highlight Hot Days\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-hot-periods_45b1866fdafcecab29393b9da4547aa6'}\n\n```{.r .cell-code  code-line-numbers=\"1|2,3,4,5,6|2,3,4,5,6,11|7,8,9,10|5,12,13,14,15\"}\ngh <- \n  ggplot(\n    data = filter(bikes, temp >= 27),\n    aes(x = date, y = temp)\n  ) +\n  geom_point(\n    data = bikes,\n    color = \"grey65\", alpha = .3\n  ) +\n  geom_point(size = 2.5)\n\ngh\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-hot-periods-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with geom_text()\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-text_82538f84e54233274cb9dba38a2b5403'}\n\n```{.r .cell-code  code-line-numbers=\"2,6|3|4,5\"}\ngh +\n  geom_text(\n    aes(label = format(date, \"%m/%d\")),\n    nudge_x = 10,\n    hjust = 0\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-text-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with geom_label()\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-label_7c1451d98ce3d0cbf3b5cd3aa8448ce1'}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\ngh +\n  geom_label(\n    aes(label = format(date, \"%m/%d\")),\n    nudge_x = .3,\n    hjust = 0\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-label-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggrepel}\n\n\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-text-repel_5174350004dab0ef2a173a1f5e48e684'}\n\n```{.r .cell-code  code-line-numbers=\"2,3,4\"}\ngh +\n  ggrepel::geom_text_repel(\n    aes(label = format(date, \"%m/%d\"))\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-text-repel-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggrepel}\n\n\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-text-repel-styling_03c90c0cd7d62b5a73d606bee972da7e'}\n\n```{.r .cell-code  code-line-numbers=\"3|4,5,6\"}\ngh + \n  ggrepel::geom_text_repel(\n    aes(label = format(date, \"%m/%d\")),\n    family = \"Spline Sans Mono\",\n    size = 4.5,\n    fontface = \"bold\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-text-repel-styling-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggrepel}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-text-repel-dist_fbf571d53af6b926a25268366d5fe10d'}\n\n```{.r .cell-code  code-line-numbers=\"5,6|7,8\"}\ngh +\n  ggrepel::geom_text_repel(\n    aes(label = format(date, \"%m/%d\")),\n    family = \"Spline Sans Mono\",\n    # space between points + labels\n    box.padding = .8,\n    # always draw segments\n    min.segment.length = 0\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-text-repel-dist-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggrepel}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-text-repel-lim_c2883ef11b91ecea90b94797b2c184ae'}\n\n```{.r .cell-code  code-line-numbers=\"5,6|5,6,7|3\"}\ngh +\n  ggrepel::geom_text_repel(\n    aes(label = format(date, \"%y/%m/%d\")),\n    family = \"Spline Sans Mono\",\n    # force to the right\n    xlim = c(NA, as.Date(\"2015-06-01\")), \n    hjust = 1\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-text-repel-lim-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggrepel}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-text-repel-arrow_489ac2af4bc33304dda1f02f3073df73'}\n\n```{.r .cell-code  code-line-numbers=\"6,7,8\"}\ngh +\n  ggrepel::geom_text_repel(\n    aes(label = format(date, \"%y/%m/%d\")),\n    family = \"Spline Sans Mono\",\n    xlim = c(NA, as.Date(\"2015-06-01\")),\n    # style segment\n    segment.curvature = .01,\n    arrow = arrow(length = unit(.02, \"npc\"), type = \"closed\")\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-text-repel-arrow-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggrepel}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-text-repel-inflect_58faf9092519b5b2967c88ab35c0c92b'}\n\n```{.r .cell-code  code-line-numbers=\"8\"}\ngh +\n  ggrepel::geom_text_repel(\n    aes(label = format(date, \"%y/%m/%d\")),\n    family = \"Spline Sans Mono\",\n    xlim = c(NA, as.Date(\"2015-06-01\")),\n    # style segment\n    segment.curvature = .001,\n    segment.inflect = TRUE\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-text-repel-inflect-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggforce}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-mark-rect_f4cb5430bdad17bdfa69718a5b3bd84c'}\n\n```{.r .cell-code  code-line-numbers=\"2,5|3,4\"}\ng +\n  ggforce::geom_mark_rect(\n    aes(label = \"Outliers?\",\n        filter = count > 40000)\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-mark-rect-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggforce}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-mark-rect-color_84d28429842292d52ac7bdc61a414a63'}\n\n```{.r .cell-code  code-line-numbers=\"5,6\"}\ng +\n  ggforce::geom_mark_rect(\n    aes(label = \"Outliers?\",\n        filter = count > 40000),\n    color = \"black\",\n    label.family = \"Asap SemiCondensed\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-mark-rect-color-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggforce}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-mark-rect-description_6e3f3794b67f33c15867f57ba5641238'}\n\n```{.r .cell-code  code-line-numbers=\"11,12,13\"}\ng +\n  ggforce::geom_mark_rect(\n    aes(label = \"Outliers?\",\n        filter = count > 40000),\n    description = \"What happened on\\nthese two days?\",\n    color = \"black\",\n    label.family = \"Asap SemiCondensed\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-mark-rect-description-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggforce}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-mark-rect-modify_a8d179294c1c5068cbe5aa416dd9759a'}\n\n```{.r .cell-code  code-line-numbers=\"8,9,10,11,12,13\"}\ng +\n  ggforce::geom_mark_rect(\n    aes(label = \"Outliers?\",\n        filter = count > 40000),\n    description = \"What happened on\\nthese two days?\",\n    color = \"black\",\n    label.family = \"Asap SemiCondensed\",\n    expand = unit(8, \"pt\"),\n    radius = unit(12, \"pt\"),\n    con.cap = unit(0, \"pt\"),\n    label.buffer = unit(15, \"pt\"),\n    con.type = \"straight\",\n    label.fill = \"transparent\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-mark-rect-modify-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggforce}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-mark-circle_6116ff39c967c62d0abc3b08fc524d9f'}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\ng +\n  ggforce::geom_mark_circle(\n    aes(label = \"Outliers?\",\n        filter = count > 40000),\n    description = \"What happened on\\nthese two days?\",\n    color = \"black\",\n    label.family = \"Asap SemiCondensed\",\n    expand = unit(8, \"pt\"),\n    con.cap = unit(0, \"pt\"),\n    label.buffer = unit(15, \"pt\"),\n    con.type = \"straight\",\n    label.fill = \"transparent\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-mark-circle-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {ggforce}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/highlight-geom-mark-hull_ddc0452b5cc98e8ea62ef01f522cb020'}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\ng +\n  ggforce::geom_mark_hull(\n    aes(label = \"Outliers?\",\n        filter = count > 40000),\n    description = \"What happened on\\nthese two days?\",\n    color = \"black\",\n    label.family = \"Asap SemiCondensed\",\n    expand = unit(8, \"pt\"),\n    con.cap = unit(0, \"pt\"),\n    label.buffer = unit(15, \"pt\"),\n    con.type = \"straight\",\n    label.fill = \"transparent\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/highlight-geom-mark-hull-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Annotations with {geomtextpath}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/geomtextpath-prep_4625e050cd331fc0199ca06c59fb3047'}\n\n```{.r .cell-code  code-line-numbers=\"1,2,3,4|5,6,7,8|9|10,11,12,13,14,15|16,17,18,19\"}\nbikes |>\n  filter(year == \"2016\") |>\n  group_by(month, day_night) |> \n  summarize(count = sum(count)) |> \n  ggplot(aes(x = month, y = count, \n             color = day_night,\n             group = day_night)) +\n  geom_line(linewidth = 1) +\n  coord_cartesian(expand = FALSE) +\n  scale_y_continuous(\n    labels = scales::label_comma(\n      scale = 1/10^3, suffix = \"K\"\n    ),\n    limits = c(0, 850000)\n  ) +\n  scale_color_manual(\n    values = c(\"#FFA200\", \"#757BC7\"),\n    name = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/geomtextpath-prep-1.png){width=1000}\n:::\n:::\n\n\n\n## Annotations with {geomtextpath}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/geomtextpath_deff383ae9ffd53f9b8d48d15880ff83'}\n\n```{.r .cell-code  code-line-numbers=\"8,9,10,11,12,13,14|24\"}\nbikes |>\n  filter(year == \"2016\") |>\n  group_by(month, day_night) |> \n  summarize(count = sum(count)) |> \n  ggplot(aes(x = month, y = count, \n             color = day_night,\n             group = day_night)) +\n  geomtextpath::geom_textline(\n    aes(label = day_night),\n    linewidth = 1,\n    vjust = -.5, \n    family = \"Asap SemiCondensed\",\n    fontface = \"bold\"\n  ) +\n  coord_cartesian(expand = FALSE) +\n  scale_y_continuous(\n    labels = scales::label_comma(\n      scale = 1/10^3, suffix = \"K\"\n    ),\n    limits = c(0, 850000)\n  ) +\n  scale_color_manual(\n    values = c(\"#FFA200\", \"#757BC7\"),\n    guide = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/geomtextpath-1.png){width=1000}\n:::\n:::\n\n\n\n## Annotations with {geomtextpath}\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/geomtextpath-long_d056bb56350d8f8b92d69357ca94e93f'}\n\n```{.r .cell-code  code-line-numbers=\"5,6,7,8,9|17\"}\nbikes |>\n  filter(year == \"2016\") |>\n  group_by(month, day_night) |> \n  summarize(count = sum(count)) |> \n  mutate(day_night = if_else(\n    day_night == \"day\", \n    \"Day period (6am-6pm)\", \n    \"Night period (6pm-6am)\"\n  )) |> \n  ggplot(aes(x = month, y = count, \n             color = day_night,\n             group = day_night)) +\n  geomtextpath::geom_textline(\n    aes(label = day_night),\n    linewidth = 1,\n    vjust = -.5, \n    hjust = .05,\n    family = \"Asap SemiCondensed\",\n    fontface = \"bold\"\n  ) +\n  coord_cartesian(expand = FALSE) +\n  scale_y_continuous(\n    labels = scales::label_comma(\n      scale = 1/10^3, suffix = \"K\"\n    ),\n    limits = c(0, 850000)\n  ) +\n  scale_color_manual(\n    values = c(\"#FFA200\", \"#757BC7\"),\n    guide = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/geomtextpath-long-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Line Chart with \\`stat_summary()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/line-stat_4d8fbc39bac7977a56b3fdb7922a09c6'}\n\n```{.r .cell-code  code-line-numbers=\"1,2|6,7,8,9\"}\nbikes |>\n  filter(year == \"2016\") |>\n  ggplot(aes(x = month, y = count, \n             color = day_night,\n             group = day_night)) +\n  stat_summary(\n    geom = \"line\", fun = sum,\n    linewidth = 1\n  ) +\n  coord_cartesian(expand = FALSE) +\n  scale_y_continuous(\n    labels = scales::label_comma(\n      scale = 1/10^3, suffix = \"K\"\n    ),\n    limits = c(0, 850000)\n  ) +\n  scale_color_manual(\n    values = c(\"#FFA200\", \"#757BC7\"),\n    name = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/line-stat-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Line Chart with \\`stat_summary()\\`\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/line-stat-textpath-fail_3396b8554fc3c630952fbda22f114db4'}\n\n```{.r .cell-code  code-line-numbers=\"10,11,12,13\"}\nbikes |>\n  filter(year == \"2016\") |>\n  ggplot(aes(x = month, y = count, \n             color = day_night,\n             group = day_night)) +\n  stat_summary(\n    geom = \"line\", fun = sum,\n    linewidth = 1\n  ) +\n  geomtextpath::geom_textline(\n    aes(label = day_night), \n    stat = \"summary\" # fails\n  ) +\n  coord_cartesian(expand = FALSE) +\n  scale_y_continuous(\n    labels = scales::label_comma(\n      scale = 1/10^3, suffix = \"K\"\n    ),\n    limits = c(0, 850000)\n  ) +\n  scale_color_manual(\n    values = c(\"#FFA200\", \"#757BC7\"),\n    name = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/line-stat-textpath-fail-1.png){width=1000}\n:::\n:::\n\n\n\n\n# Adding Images\n\n\n\n## Load Image\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"1|2|4\"}\nurl <- \"https://www.gs.tum.de/fileadmin/_processed_/0/7/csm_UGI_Logo_frei_ba00944e1c.png\"\nimg <- magick::image_read(url)\n\nimg\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/read-img-1.png){width=24}\n:::\n:::\n\n\n\n\n## Add Background Image\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-custom_3b1d90be0e19abedb1473b19cee055d1'}\n\n```{.r .cell-code  code-line-numbers=\"3,4,5,6|3|4\"}\nggplot(bikes, aes(date, temp)) +\n  annotation_custom(\n    grid::rasterGrob(\n      image = img\n    )\n  ) +\n  geom_point(color = \"#308DD1\")\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-custom-1.png){width=1000}\n:::\n:::\n\n\n## Adjust Position\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-custom-position_89fef3d4a9319ce58ee210ad62e3d8c7'}\n\n```{.r .cell-code  code-line-numbers=\"5,6,7,11\"}\nggplot(bikes, aes(date, temp)) +\n  annotation_custom(\n    grid::rasterGrob(\n      image = img,\n      x = .5,\n      y = .75,\n      width = .3\n    )\n  ) +\n  geom_point(color = \"#308DD1\") +\n  ylim(NA, 35)\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-custom-position-1.png){width=1000}\n:::\n:::\n\n\n\n\n## Place Image Outside\n\n\n::: {.cell output-location='column' hash='04-annotations_cache/revealjs/annotate-custom-position-outside_615334aec684ebdb5681e3dc65d051e0'}\n\n```{.r .cell-code  code-line-numbers=\"5,6,11,12,13,14|6,11,13\"}\nggplot(bikes, aes(date, temp)) +\n  annotation_custom(\n    grid::rasterGrob(\n      image = img,\n      x = .9,\n      y = 1.2,\n      width = .3\n    )\n  ) +\n  geom_point(color = \"#308DD1\") +\n  coord_cartesian(clip = \"off\") +\n  theme(\n    plot.margin = margin(120, 10, 10, 10)\n  )\n```\n\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/annotate-custom-position-outside-1.png){width=1000}\n:::\n:::\n\n\n\n\n## <b style='color:#663399;'>Recap</b>\n\n::: recap\n::: incremental\n-   style labels such as title, axis and legend texts with **`theme()`**\n-   format data-related labels with the **`labels`** argument of `scale_*()`\n-   adjust strip text with the **`facet_*(labeller)`** functionality\n-   add data-related annotations with **`geom_text|label()`**\n-   ... and data-unrelated annotations with **`annotate()`**\n-   use **`annotation_custom(rasterGrob())`** to add images\n-   **`{ggtext}`** allows to render labels with markdown and basic html\n-   `{ggtext}` also allows to add **dynamic linebreaks** and images\n-   **`{ggrepel}`** ensures clever placement of annotations\n-   **`ggforce::geom_mark_*()`** provide a set of advanced annotations\n:::\n:::\n\n\n\n# Exercises\n\n\n\n## Exercise 1\n\n::: question\n-  **Take a look at the following visualization.**\n   -  For each group of text labels, note how one would add and modify them.\n   -  Discuss how to automate the placement of the labels in- and outside of the bars.\n:::\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-plot_9309d3f68f8bc371d159cd02e23587f2'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-plot-1.png){width=1500}\n:::\n:::\n\n\n\n## Exercise 2\n\n::: question\n-   {ggtext} also comes with some new geom's. Explore those and other options on the package webpage: [wilkelab.rg/ggtext](https://wilkelab.org/ggtext/).\n-   {ggforce} comes with a variety of interesting geometries and utilities. Take a look at this wonderful toolbox: [ggforce.data-imaginist.com](https://ggforce.data-imaginist.com/). Share potentially helpful features with the group.\n:::\n\n\n\n# Solution Exercise 1 {background-color=\"#e6d9f2\"}\n\n\n\n## Exercise 1\n\n::: question\n-  **Take a look at the following visualization.**\n   -  For each group of text labels, note how one would add and modify them.\n   -  Discuss how to automate the placement of the labels in- and outside of the bars.\n:::\n\n\n\n## Horizontal Bar Chart\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"1|2,3,4|5|6,7,8,9|7|10|11|12,13,14,15,16\"}\np <- \n  bikes |> \n  filter(!is.na(weather_type), year == \"2015\") |> \n  summarize(n = sum(count), .by = weather_type) |> \n  ggplot(aes(x = n, y = forcats::fct_reorder(weather_type, n))) +\n  geom_col(color = \"grey20\", fill = \"beige\", width = .7) +\n  scale_x_continuous(expand = c(0, 0)) +\n  coord_cartesian(clip = \"off\") +\n  theme_minimal(base_size = 14, base_family = \"Asap SemiCondensed\") +\n  theme(\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n\np\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-0_47cbfdc95fddee26b54b414a8d404372'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-1-labels-0-1.png){width=1500}\n:::\n:::\n\n\n\n## Add Count Annotations\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-1_2656233f27a04107f02c4a046aa6fe8e'}\n\n```{.r .cell-code  code-line-numbers=\"2,3,4,5,6|3|4\"}\np +\n  geom_text(\n    aes(label = n),\n    family = \"Asap SemiCondensed\"\n  )\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-1_f2e8aed9d1893ccb7b68840a2808e3f1'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-1-labels-1-1.png){width=1500}\n:::\n:::\n\n\n\n## Add Count Annotations\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-2_bb749e690ee7f790a4fcbfe5c1701d3f'}\n\n```{.r .cell-code  code-line-numbers=\"4,5|5\"}\np +\n  geom_text(\n    aes(label = n,\n        hjust = n > .5*10^6),\n    family = \"Asap SemiCondensed\"\n  )\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-2_5962484ac24fb52559ab80ed1dd3daa6'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-1-labels-2-1.png){width=1500}\n:::\n:::\n\n\n\n## Add Count Annotations\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-3_2c2778687a5f040de3da97b9d4fc2af6'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\np +\n  geom_text(\n    aes(label = paste0(\"  \", sprintf(\"%2.2f\", n / 10^6), \"M  \"),\n        hjust = n > .5*10^6),\n    family = \"Asap SemiCondensed\"\n  )\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-3_9d0d869eeda11550d88c7e2675852180'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-1-labels-3-1.png){width=1500}\n:::\n:::\n\n\n\n## Polish Axes\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-4_2580c2a14b0ccb9ad584e319acea16c9'}\n\n```{.r .cell-code  code-line-numbers=\"8,9,10,11|9|9,12,13,14|10\"}\np +\n  geom_text(\n    aes(label = paste0(\"  \", sprintf(\"%2.2f\", n / 10^6), \"M  \"),\n        hjust = n > .5*10^6),\n    family = \"Asap SemiCondensed\"\n  ) +\n  scale_x_continuous(\n    expand = c(0, 0), name = \"**Reported bike shares**, in millions\", \n    breaks = 0:4*10^6, labels = c(\"0\", paste0(1:4, \"M\"))\n  ) +\n  theme(\n    axis.title.x = ggtext::element_markdown(hjust = 0, face = \"italic\")\n  )\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-4_598b71c4c67dd33f2f79a08dae03f87c'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-1-labels-4-1.png){width=1500}\n:::\n:::\n\n\n\n## Polish Axes Labels\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-5_b782946c82bd338893b8635d0d737ac8'}\n\n```{.r .cell-code  code-line-numbers=\"12,13,14|13|17\"}\np +\n  geom_text(\n    aes(label = paste0(\"  \", sprintf(\"%2.2f\", n / 10^6), \"M  \"),\n        hjust = n > .5*10^6),\n    family = \"Asap SemiCondensed\"\n  ) +\n  scale_x_continuous(\n    expand = c(0, 0), name = \"**Reported bike shares**, in millions\", \n    breaks = 0:4*10^6, labels = c(\"0\", paste0(1:4, \"M\"))\n  ) +\n  scale_y_discrete(\n    labels = stringr::str_to_sentence, name = NULL\n  ) +\n  theme(\n    axis.title.x = ggtext::element_markdown(hjust = 0, face = \"italic\"),\n    axis.text.y = element_text(color = \"black\", size = rel(1.2))\n  )\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-5_af2db5588757b85ba34c6bdb9ad4dcd1'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-1-labels-5-1.png){width=1500}\n:::\n:::\n\n\n\n## Add Titles\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-6_b53b2f6e53606c9d5889d145674c6375'}\n\n```{.r .cell-code  code-line-numbers=\"15,16,17,18,19|16,23,24|17,23,25|18,26\"}\np +\n  geom_text(\n    aes(label = paste0(\"  \", sprintf(\"%2.2f\", n / 10^6), \"M  \"),\n        hjust = n > .5*10^6),\n    family = \"Asap SemiCondensed\"\n  ) +\n  scale_x_continuous(\n    expand = c(0, 0), name = \"**Reported bike shares**, in millions\", \n    breaks = 0:4*10^6, labels = c(\"0\", paste0(1:4, \"M\"))\n  ) +\n  scale_y_discrete(\n    labels = stringr::str_to_sentence, name = NULL\n  ) +\n  labs(\n    title = \"Fair weather preferred—even in London\",\n    subtitle = \"Less than 10% of TfL bikes shares have been reported on rainy, cloudy, or snowy days in 2015.\",\n    caption = \"**Data:** Transport for London / freemeteo.com\"\n  ) +\n  theme(\n    axis.title.x = ggtext::element_markdown(hjust = 0, face = \"italic\"),\n    axis.text.y = element_text(color = \"black\", size = rel(1.2)),\n    plot.title.position = \"plot\",\n    plot.title = element_text(face = \"bold\"),\n    plot.subtitle = element_text(margin = margin(b = 20)),\n    plot.caption = ggtext::element_markdown(color = \"grey40\")\n  )\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-6_500f45c172182602267ed42a22fee0c4'}\n::: {.cell-output-display}\n![](04-annotations_files/figure-revealjs/exercise-1-labels-6-1.png){width=1500}\n:::\n:::\n\n\n\n## Full Code\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-full_6710cb57e0b50d81f92a624423400fbc'}\n\n```{.r .cell-code}\nbikes |> \n  filter(!is.na(weather_type), year == \"2015\") |> \n  summarize(n = sum(count), .by = weather_type) |> \n  ggplot(aes(x = n, y = forcats::fct_reorder(weather_type, n))) +\n  geom_col(color = \"grey20\", fill = \"beige\", width = .7) +\n  geom_text(\n    aes(label = paste0(\"  \", sprintf(\"%2.2f\", n / 10^6), \"M  \"),\n        hjust = n > .5*10^6),\n    family = \"Asap SemiCondensed\"\n  ) +\n  scale_x_continuous(\n    breaks = 0:4*10^6,\n    labels = c(\"0\", paste0(1:4, \"M\")),\n    expand = c(0, 0), \n    name = \"**Reported bike shares**, in millions\"\n  ) +\n  scale_y_discrete(labels = stringr::str_to_sentence, name = NULL) +\n  coord_cartesian(clip = \"off\") +\n  labs(\n    title = \"Fair weather preferred—even in London\",\n    subtitle = \"Less than 10% of TfL bikes shares have been reported on rainy, cloudy, or snowy days in 2015.\",\n    caption = \"**Data:** Transport for London / freemeteo.com\"\n  ) +\n  theme_minimal(base_size = 14, base_family = \"Asap SemiCondensed\") +\n  theme(\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.title.x = ggtext::element_markdown(hjust = 0, face = \"italic\"),\n    axis.text.y = element_text(color = \"black\", size = rel(1.2)),\n    plot.title = element_text(face = \"bold\"),\n    plot.subtitle = element_text(margin = margin(b = 20)),\n    plot.title.position = \"plot\",\n    plot.caption = ggtext::element_markdown(color = \"grey40\")\n  )\n```\n:::\n\n\n\n## Full Code with \\`stat_summary()\\`\n\n\n::: {.cell hash='04-annotations_cache/revealjs/exercise-1-labels-full-stat_391d6db07b0b0096198b3f774a03c836'}\n\n```{.r .cell-code  code-line-numbers=\"3|3,5,6,8|3,5,6,8,9,10,11,12,13,14,16\"}\nbikes |> \n  filter(year == \"2015\") |> \n  mutate(weather_type = forcats::fct_reorder(weather_type, count, .fun = sum)) |> \n  ggplot(aes(x = count, y = weather_type)) +\n  stat_summary(\n    geom = \"bar\", fun = sum, \n    color = \"grey20\", fill = \"beige\", width = .7\n  ) +\n  stat_summary(\n    geom = \"text\", fun = sum,\n    aes(\n      label = after_stat(paste0(\"  \", sprintf(\"%2.2f\", x / 10^6), \"M  \")),\n      hjust = after_stat(x) > .5*10^6\n    ),\n    family = \"Asap SemiCondensed\"\n  ) +\n  scale_x_continuous(\n    breaks = 0:4*10^6,\n    labels = c(\"0\", paste0(1:4, \"M\")),\n    expand = c(0, 0), \n    name = \"**Reported bike shares**, in millions\"\n  ) +\n  scale_y_discrete(labels = stringr::str_to_sentence, name = NULL) +\n  coord_cartesian(clip = \"off\") +\n  labs(\n    title = \"Fair weather preferred—even in London\",\n    subtitle = \"Less than 10% of TfL bikes shares have been reported on rainy, cloudy, or snowy days in 2015.\",\n    caption = \"**Data:** Transport for London / freemeteo.com\"\n  ) +\n  theme_minimal(base_size = 14, base_family = \"Asap SemiCondensed\") +\n  theme(\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.title.x = ggtext::element_markdown(hjust = 0, face = \"italic\"),\n    axis.text.y = element_text(color = \"black\", size = rel(1.2)),\n    plot.title = element_text(face = \"bold\"),\n    plot.subtitle = element_text(margin = margin(b = 20)),\n    plot.title.position = \"plot\",\n    plot.caption = ggtext::element_markdown(color = \"grey40\")\n  )\n```\n:::\n\n\n\n\n# Solution Exercise 2 {background-color=\"#e6d9f2\"}\n\n\n\n## Exercise 2\n\n::: question\n-   {ggtext} also comes with some new geom's. Explore those and other options on the package webpage: [wilkelab.rg/ggtext](https://wilkelab.org/ggtext/).\n-   {ggforce} comes with a variety of interesting geometries and utilities. Take a look at this wonderful toolbox: [ggforce.data-imaginist.com](https://ggforce.data-imaginist.com/). Share potentially helpful features with the group.\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}